<mat-progress-bar *ngIf="loading" mode="indeterminate"></mat-progress-bar>
<div class="container-order">

  <div *ngFor="let quotation of quotations; let i = index">
    <ul class="cotation-list-table">
      <li class="head clearfix">
        <div class="col-row clearfix" style="background: #444; color: #fff; font-size: 14px;padding: 8px;">
          <div class="col col-2"></div>
          <div class="col col-8">
            <div class="col col-4 text-center">Milhas</div>
            <div class="col col-4"> Programa de Fidelidade</div>
            <div class="col col-4 text-center">Valor</div>
          </div>
          <div *ngIf="quotation.status_orders" class="col col-2 text-center">Status</div>
        </div>
      </li>

      <li class="body clearfix">
        <div class="col col-2" style="background: #0275d8; color: #fff">
          <div class="cotation-box-title">
            <span class="id">
              <small>Cotação</small>
              {{quotation.id}}
            </span>
            <span class="date">
              {{quotation.created_at | date: 'dd/MM/yyyy'}}
            </span>
          </div>
        </div>

        <div class="col col-8">
          <div *ngFor="let program of quotation.programs">
            <div class="col-row clearfix border-bottom" style="background: #fff;">
              <div class="col col-4 col-valores text-center">
                <span class="title">
                  {{program.value}} mil
                </span>
              </div><!-- /.col-milhas -->
              <div class="col col-4 col-programa">
                <span class="programa-fidelidade">
                  <span class="logo">
                    <img [alt]="program.program_title" [src]="'assets/imgs/cias/'+program.program_code.toLowerCase()+'.png'" style="width: 42px"/>
                    ({{detailsFidelities[program.program_id-1].title}})
                  </span>
                </span>
              </div><!-- /.col-programa -->
              <div class="col col-valores col-4 text-center">
                <span class="valor">
                  {{program.price | currency:'R$'}}
                </span>
              </div>
            </div><!-- /.col-row -->

            <div class="col-row clearfix border-bottom" *ngIf="isVisibleForm(quotation.id)">

              <div class="col col-6">
                <div class="form-group">
                  <label *ngIf="['JJ', 'TRB'].includes(program.program_code)" for="tamCartao">
                    CPF
                  </label>
                  <label *ngIf="['AD', 'AV', 'G3', 'G3D'].includes(program.program_code)" for="tamCartao">
                    Nº do cartão {{detailsFidelities[program.program_id-1].title}}
                  </label>
                  <div class="input text">
                    <input type="text" class="form-control" readonly="{{detailsFidelities[(program.program_id - 1)].card_number ? 'readonly' : ''}}"
                           [(ngModel)]="fidelities[quotation.id][program.program_id].number" maxlength="20">
                  </div>
                </div>
              </div>
              <div class="col col-6">
                <div class="form-group">
                  <label for="tamSenha">Senha de Acesso {{detailsFidelities[program.program_id-1].password_type}}</label>
                  <div class="input text">
                    <input type="password" class="form-control" [(ngModel)]="fidelities[quotation.id][program.program_id].access_password">
                  </div>
                </div>
              </div>

              <div class="col-row">
                <div class="col col-6">
                    <a style="cursor: pointer"
                      onclick="window.open('https://www.techtudo.com.br/dicas-e-tutoriais/noticia/2013/09/como-tirar-screenshots-no-windows-e-salvar-capturas-de-tela-no-computador.html')"> Não sabe capturar tela? Aprenda a "printar"...</a> 
                  <div class="form-group">
                      <label for="{{program.program_title.toLowerCase()}}Print-0" class="btn btn-primary">Inicial&hellip;</label>
                      <span class="upload mr-2">
                        <input name="inicial-{{program.program_code}}-{{quotation.id}}" id="{{program.program_title.toLowerCase()}}Print-0"
                        type="file" style="display: none" (change)="uploadFile($event, quotation.id, program.program_id)">
                      </span>
                    <label for="{{program.program_title.toLowerCase()}}Print-1" class="btn btn-primary">Extrato&hellip;</label>
                      <span class="upload">
                          <input name="extract-{{program.program_code}}-{{quotation.id}}" id="{{program.program_title.toLowerCase()}}Print-1"
                          type="file" style="display: none" (change)="uploadFile($event, quotation.id, program.program_id)">
                      </span>
                    </div>
                </div>
                <div class="col col-6"> Dados cadastrais
                  <div class="form-group">
                      <label for="{{program.program_title.toLowerCase()}}Print-2" class="btn btn-primary">Celular&hellip;</label>
                        <span class="upload mr-2">
                          <input name="cellphone-{{program.program_code}}-{{quotation.id}}" id="{{program.program_title.toLowerCase()}}Print-2"
                          type="file" style="display: none" (change)="uploadFile($event, quotation.id, program.program_id)">
                        </span>
                      <label for="{{program.program_title.toLowerCase()}}Print-3" class="btn btn-primary">Endereço&hellip;</label>
                        <span class="upload">
                            <input name="address-{{program.program_code}}-{{quotation.id}}" id="{{program.program_title.toLowerCase()}}Print-3"
                            type="file" style="display: none" (change)="uploadFile($event, quotation.id, program.program_id)">
                        </span>
                  </div>
                </div>
              </div>

            </div>
          </div>
          <div class="col-row-valor clearfix">
            <div class="col text-center" style="font-size: 15px;">
              <span class="title">Valor Total: <strong>{{quotation.total | currency:'R$'}}</strong></span>
            </div>
          </div>
        </div>

        <div class="col col-2 clearfix" style="background: #0275d8; color: #fff">
          <button class="button button-select" (click)="sellQuotation(quotation.id)" *ngIf="!isVisibleForm(quotation.id) && !quotation.status_orders && i == 0">Vender</button>
          <button class="button button-select" (click)="saveFidelities(quotation.id)" *ngIf="isVisibleForm(quotation.id) && !quotation.status_orders">Confirmar</button>
          <button class="button button-select" (click)="unsellQuotation(quotation.id)" *ngIf="isVisibleForm(quotation.id) && !quotation.status_orders">Cancelar</button>
          <span *ngIf="quotation.status_orders" >
            <p *ngFor="let status of quotation.status_orders;" style="margin-bottom: 0rem">
               <img style="width: 42px" [alt]="status.program" [src]="'assets/imgs/cias/'+status.program.toLowerCase()+'.png'" style="width: 30%"/> {{status.status.toUpperCase()}}
            </p>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>

<section class="wrapper" *ngIf="loading || (!loading && quotations.length == 0)">
  <div class="container-fornecedor">
    <div style="width: 100%;text-align: center;padding: 20px;">
      <h3 *ngIf="loading" > Carregando...</h3>
      <h3 *ngIf="!loading && quotations.length == 0">Nenhuma cotação recente</h3>
    </div>
  </div>
</section>
